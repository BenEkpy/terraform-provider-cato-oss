---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "cato-oss_if_rule Resource - terraform-provider-cato-oss"
subcategory: ""
description: |-
  The cato-oss_if_policy resource contains the configuration parameters necessary to internet firewall rules (https://support.catonetworks.com/hc/en-us/articles/4413273486865-What-is-the-Cato-Internet-Firewall). Documentation for the underlying API used in this resource can be found atmutation.policy.internetFirewall.addRule() https://api.catonetworks.com/documentation/#mutation-policy.internetFirewall.addRule.
---

# cato-oss_if_rule (Resource)

The `cato-oss_if_policy` resource contains the configuration parameters necessary to internet firewall rules (https://support.catonetworks.com/hc/en-us/articles/4413273486865-What-is-the-Cato-Internet-Firewall). Documentation for the underlying API used in this resource can be found at[mutation.policy.internetFirewall.addRule()](https://api.catonetworks.com/documentation/#mutation-policy.internetFirewall.addRule).

## Example Usage

```terraform
resource "cato-oss_wf_rule" "rname" {
  at = {
    position = "LAST_IN_POLICY"
  }
  rule = {
    name        = "first TF Internet FW Rule"
    description = "terraform test"
    enabled     = true
    action      = "ALLOW"
    source = {
      ip     = ["1.1.1.1", "2.2.2.3"]
      subnet = ["10.10.10.0/24"]
      ip_range = [
        {
          from = "10.10.10.40"
          to   = "10.10.10.100"
        }
      ]
    }
    device_os = [
      "MACOS"
    ]
    destination = {
      ip     = ["1.1.1.1", "2.2.2.3"]
      subnet = ["10.10.10.0/24"]
      ip_range = [
        {
          from = "10.10.10.40"
          to   = "10.10.10.100"
        }
      ]
    }
    application = {
      app_category = [
        {
          id = "p2p"
        }
      ]
      subnet = ["10.10.10.0/24"]
    }
    service = {
      standard = [
        {
          id = "ftp"
        },
        {
          name = "SMTP"
        }
      ]
      custom = [
        {
          port_range = {
            from = "200"
            to   = "1000"
          }
          port     = ["100", "105", "123"]
          protocol = "TCP"
        }
      ]
    }
    tracking = {
      event = {
        enabled = true
      }
      alert = {
        enabled   = true
        frequency = "HOURLY"
        mailing_list = [
          {
            id = "6893"
          }
        ]
      }
    }
    schedule = {
      active_on = "CUSTOM_RECURRING"
      custom_recurring = {
        from = "10:15:30"
        to   = "18:15:30"
        days = [
          "MONDAY",
          "TUESDAY"
        ]
      }
    }
    exceptions = [
      {
        name = "exception 1"
        direction = "BOTH"
        service = {
          standard = [
            {
              id = "ftp"
            },
            {
              name = "SMTP"
            }
          ]
          custom = [
            {
              port_range = {
                from = "200"
                to   = "1001"
              }
              port     = ["100", "105", "123"]
              protocol = "UDP"
            }
          ]
        }
        country = [
          {
            id = "US"
          },
          {
            name = "Spain"
          }
        ]
        source = {
          ip = ["1.1.1.5", "2.2.2.3"]
          ip_range = [
            {
              from = "10.0.0.0"
              to   = "10.0.0.10"
            }
          ]
        }
      },
      {
        name = "exception 2"
        direction = "BOTH"
        application = {
          app_category = [
            {
              id = "p2p"
            }
          ]
          ip = ["10.1.1.12"]
          subnet = ["10.10.10.0/24"]
        }
        device_os = [
          "WINDOWS"
        ]
      }
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `at` (Attributes) Position of the rule in the policy (see [below for nested schema](#nestedatt--at))
- `rule` (Attributes) Parameters for the rule you are adding (see [below for nested schema](#nestedatt--rule))

<a id="nestedatt--at"></a>
### Nested Schema for `at`

Required:

- `position` (String) Position relative to a policy, a section or another rule

Optional:

- `ref` (String) The identifier of the object (e.g. a rule, a section) relative to which the position of the added rule is defined


<a id="nestedatt--rule"></a>
### Nested Schema for `rule`

Required:

- `action` (String)
- `enabled` (Boolean) Internet firewall rule state
- `name` (String) Internet firewall rule name

Optional:

- `connection_origin` (String) Connection origin of the traffic
- `country` (Attributes List) Source country traffic matching criteria. Logical ‘OR’ is applied within the criteria set. Logical ‘AND’ is applied between criteria sets. (see [below for nested schema](#nestedatt--rule--country))
- `description` (String) Internet firewall rule description
- `destination` (Attributes) (see [below for nested schema](#nestedatt--rule--destination))
- `device` (Attributes List) (see [below for nested schema](#nestedatt--rule--device))
- `device_os` (List of String)
- `exceptions` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions))
- `index` (Number) Internet firewall rule index
- `schedule` (Attributes) (see [below for nested schema](#nestedatt--rule--schedule))
- `section` (Attributes) (see [below for nested schema](#nestedatt--rule--section))
- `service` (Attributes) (see [below for nested schema](#nestedatt--rule--service))
- `source` (Attributes) Source traffic matching criteria. Logical ‘OR’ is applied within the criteria set. Logical ‘AND’ is applied between criteria sets. (see [below for nested schema](#nestedatt--rule--source))
- `tracking` (Attributes) (see [below for nested schema](#nestedatt--rule--tracking))

Read-Only:

- `id` (String) Internet firewall rule ID

<a id="nestedatt--rule--country"></a>
### Nested Schema for `rule.country`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination"></a>
### Nested Schema for `rule.destination`

Optional:

- `app_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--app_category))
- `application` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--application))
- `country` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--country))
- `custom_app` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--custom_app))
- `custom_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--custom_category))
- `domain` (List of String)
- `fqdn` (List of String)
- `global_ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--global_ip_range))
- `ip` (List of String)
- `ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--ip_range))
- `remote_asn` (List of String)
- `sanctioned_apps_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--destination--sanctioned_apps_category))
- `subnet` (List of String)

<a id="nestedatt--rule--destination--app_category"></a>
### Nested Schema for `rule.destination.app_category`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--application"></a>
### Nested Schema for `rule.destination.application`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--country"></a>
### Nested Schema for `rule.destination.country`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--custom_app"></a>
### Nested Schema for `rule.destination.custom_app`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--custom_category"></a>
### Nested Schema for `rule.destination.custom_category`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--global_ip_range"></a>
### Nested Schema for `rule.destination.global_ip_range`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--destination--ip_range"></a>
### Nested Schema for `rule.destination.ip_range`

Required:

- `from` (String)
- `to` (String)


<a id="nestedatt--rule--destination--sanctioned_apps_category"></a>
### Nested Schema for `rule.destination.sanctioned_apps_category`

Optional:

- `id` (String)
- `name` (String)



<a id="nestedatt--rule--device"></a>
### Nested Schema for `rule.device`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions"></a>
### Nested Schema for `rule.exceptions`

Optional:

- `connection_origin` (String)
- `country` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--country))
- `destination` (Attributes) (see [below for nested schema](#nestedatt--rule--exceptions--destination))
- `device` (List of String)
- `device_os` (List of String)
- `name` (String)
- `service` (Attributes) (see [below for nested schema](#nestedatt--rule--exceptions--service))
- `source` (Attributes) (see [below for nested schema](#nestedatt--rule--exceptions--source))

<a id="nestedatt--rule--exceptions--country"></a>
### Nested Schema for `rule.exceptions.country`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination"></a>
### Nested Schema for `rule.exceptions.destination`

Optional:

- `app_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--app_category))
- `application` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--application))
- `country` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--country))
- `custom_app` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--custom_app))
- `custom_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--custom_category))
- `domain` (List of String)
- `fqdn` (List of String)
- `global_ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--global_ip_range))
- `ip` (List of String)
- `ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--ip_range))
- `remote_asn` (List of String)
- `sanctioned_apps_category` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--destination--sanctioned_apps_category))
- `subnet` (List of String)

<a id="nestedatt--rule--exceptions--destination--app_category"></a>
### Nested Schema for `rule.exceptions.destination.app_category`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--application"></a>
### Nested Schema for `rule.exceptions.destination.application`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--country"></a>
### Nested Schema for `rule.exceptions.destination.country`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--custom_app"></a>
### Nested Schema for `rule.exceptions.destination.custom_app`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--custom_category"></a>
### Nested Schema for `rule.exceptions.destination.custom_category`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--global_ip_range"></a>
### Nested Schema for `rule.exceptions.destination.global_ip_range`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--destination--ip_range"></a>
### Nested Schema for `rule.exceptions.destination.ip_range`

Required:

- `from` (String)
- `to` (String)


<a id="nestedatt--rule--exceptions--destination--sanctioned_apps_category"></a>
### Nested Schema for `rule.exceptions.destination.sanctioned_apps_category`

Optional:

- `id` (String)
- `name` (String)



<a id="nestedatt--rule--exceptions--service"></a>
### Nested Schema for `rule.exceptions.service`

Optional:

- `custom` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--service--custom))
- `standard` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--service--standard))

<a id="nestedatt--rule--exceptions--service--custom"></a>
### Nested Schema for `rule.exceptions.service.custom`

Optional:

- `port` (List of String)
- `port_range` (Attributes) (see [below for nested schema](#nestedatt--rule--exceptions--service--custom--port_range))
- `protocol` (String)

<a id="nestedatt--rule--exceptions--service--custom--port_range"></a>
### Nested Schema for `rule.exceptions.service.custom.port_range`

Required:

- `from` (String)
- `to` (String)



<a id="nestedatt--rule--exceptions--service--standard"></a>
### Nested Schema for `rule.exceptions.service.standard`

Optional:

- `id` (String)
- `name` (String)



<a id="nestedatt--rule--exceptions--source"></a>
### Nested Schema for `rule.exceptions.source`

Optional:

- `floating_subnet` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--floating_subnet))
- `global_ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--global_ip_range))
- `group` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--group))
- `host` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--host))
- `ip` (List of String)
- `ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--ip_range))
- `network_interface` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--network_interface))
- `site` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--site))
- `site_network_subnet` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--site_network_subnet))
- `subnet` (List of String)
- `system_group` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--system_group))
- `user` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--user))
- `users_group` (Attributes List) (see [below for nested schema](#nestedatt--rule--exceptions--source--users_group))

<a id="nestedatt--rule--exceptions--source--floating_subnet"></a>
### Nested Schema for `rule.exceptions.source.floating_subnet`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--global_ip_range"></a>
### Nested Schema for `rule.exceptions.source.global_ip_range`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--group"></a>
### Nested Schema for `rule.exceptions.source.group`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--host"></a>
### Nested Schema for `rule.exceptions.source.host`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--ip_range"></a>
### Nested Schema for `rule.exceptions.source.ip_range`

Required:

- `from` (String)
- `to` (String)


<a id="nestedatt--rule--exceptions--source--network_interface"></a>
### Nested Schema for `rule.exceptions.source.network_interface`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--site"></a>
### Nested Schema for `rule.exceptions.source.site`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--site_network_subnet"></a>
### Nested Schema for `rule.exceptions.source.site_network_subnet`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--system_group"></a>
### Nested Schema for `rule.exceptions.source.system_group`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--user"></a>
### Nested Schema for `rule.exceptions.source.user`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--exceptions--source--users_group"></a>
### Nested Schema for `rule.exceptions.source.users_group`

Optional:

- `id` (String)
- `name` (String)




<a id="nestedatt--rule--schedule"></a>
### Nested Schema for `rule.schedule`

Required:

- `active_on` (String)

Optional:

- `custom_recurring` (Attributes) (see [below for nested schema](#nestedatt--rule--schedule--custom_recurring))
- `custom_timeframe` (Attributes) (see [below for nested schema](#nestedatt--rule--schedule--custom_timeframe))

<a id="nestedatt--rule--schedule--custom_recurring"></a>
### Nested Schema for `rule.schedule.custom_recurring`

Required:

- `days` (List of String)
- `from` (String)
- `to` (String)


<a id="nestedatt--rule--schedule--custom_timeframe"></a>
### Nested Schema for `rule.schedule.custom_timeframe`

Required:

- `from` (String)
- `to` (String)



<a id="nestedatt--rule--section"></a>
### Nested Schema for `rule.section`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--service"></a>
### Nested Schema for `rule.service`

Optional:

- `custom` (Attributes List) (see [below for nested schema](#nestedatt--rule--service--custom))
- `standard` (Attributes List) (see [below for nested schema](#nestedatt--rule--service--standard))

<a id="nestedatt--rule--service--custom"></a>
### Nested Schema for `rule.service.custom`

Optional:

- `port` (List of String)
- `port_range` (Attributes) (see [below for nested schema](#nestedatt--rule--service--custom--port_range))
- `protocol` (String)

<a id="nestedatt--rule--service--custom--port_range"></a>
### Nested Schema for `rule.service.custom.port_range`

Required:

- `from` (String)
- `to` (String)



<a id="nestedatt--rule--service--standard"></a>
### Nested Schema for `rule.service.standard`

Optional:

- `id` (String)
- `name` (String)



<a id="nestedatt--rule--source"></a>
### Nested Schema for `rule.source`

Optional:

- `floating_subnet` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--floating_subnet))
- `global_ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--global_ip_range))
- `group` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--group))
- `host` (Attributes List) Hosts and servers defined for your account (see [below for nested schema](#nestedatt--rule--source--host))
- `ip` (List of String) IPv4 address
- `ip_range` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--ip_range))
- `network_interface` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--network_interface))
- `site` (Attributes List) Site defined for the account (see [below for nested schema](#nestedatt--rule--source--site))
- `site_network_subnet` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--site_network_subnet))
- `subnet` (List of String) Subnets and network ranges defined for the LAN interfaces of a site
- `system_group` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--system_group))
- `user` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--user))
- `users_group` (Attributes List) (see [below for nested schema](#nestedatt--rule--source--users_group))

<a id="nestedatt--rule--source--floating_subnet"></a>
### Nested Schema for `rule.source.floating_subnet`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--global_ip_range"></a>
### Nested Schema for `rule.source.global_ip_range`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--group"></a>
### Nested Schema for `rule.source.group`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--host"></a>
### Nested Schema for `rule.source.host`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--ip_range"></a>
### Nested Schema for `rule.source.ip_range`

Required:

- `from` (String)
- `to` (String)


<a id="nestedatt--rule--source--network_interface"></a>
### Nested Schema for `rule.source.network_interface`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--site"></a>
### Nested Schema for `rule.source.site`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--site_network_subnet"></a>
### Nested Schema for `rule.source.site_network_subnet`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--system_group"></a>
### Nested Schema for `rule.source.system_group`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--user"></a>
### Nested Schema for `rule.source.user`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--source--users_group"></a>
### Nested Schema for `rule.source.users_group`

Optional:

- `id` (String)
- `name` (String)



<a id="nestedatt--rule--tracking"></a>
### Nested Schema for `rule.tracking`

Required:

- `event` (Attributes) (see [below for nested schema](#nestedatt--rule--tracking--event))

Optional:

- `alert` (Attributes) (see [below for nested schema](#nestedatt--rule--tracking--alert))

<a id="nestedatt--rule--tracking--event"></a>
### Nested Schema for `rule.tracking.event`

Required:

- `enabled` (Boolean)


<a id="nestedatt--rule--tracking--alert"></a>
### Nested Schema for `rule.tracking.alert`

Required:

- `enabled` (Boolean)
- `frequency` (String)

Optional:

- `mailing_list` (Attributes List) (see [below for nested schema](#nestedatt--rule--tracking--alert--mailing_list))
- `subscription_group` (Attributes List) (see [below for nested schema](#nestedatt--rule--tracking--alert--subscription_group))
- `webhook` (Attributes List) (see [below for nested schema](#nestedatt--rule--tracking--alert--webhook))

<a id="nestedatt--rule--tracking--alert--mailing_list"></a>
### Nested Schema for `rule.tracking.alert.mailing_list`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--tracking--alert--subscription_group"></a>
### Nested Schema for `rule.tracking.alert.subscription_group`

Optional:

- `id` (String)
- `name` (String)


<a id="nestedatt--rule--tracking--alert--webhook"></a>
### Nested Schema for `rule.tracking.alert.webhook`

Optional:

- `id` (String)
- `name` (String)
